schema: '2.0'
stages:
  ingest:
    cmd: python -m src.data.ingest --input data/raw/water_potability.csv 
      --output data/processed/water_potability.csv
    deps:
    - path: data/raw/water_potability.csv
      hash: md5
      md5: a5eeae83d792e40da6c2f9e1eab945fc
      size: 525187
    - path: src/data/ingest.py
      hash: md5
      md5: deb61de0b0e9a28a137be2832f3c7b80
      size: 700
    outs:
    - path: data/processed/water_potability.csv
      hash: md5
      md5: a5eeae83d792e40da6c2f9e1eab945fc
      size: 525187
  preprocess:
    cmd: python -m src.data.preprocess --params configs/params.yaml
    deps:
    - path: configs/params.yaml
      hash: md5
      md5: 7db577e79af1853c85f6c22697f21d66
      size: 628
    - path: data/processed/water_potability.csv
      hash: md5
      md5: a5eeae83d792e40da6c2f9e1eab945fc
      size: 525187
    - path: src/data/preprocess.py
      hash: md5
      md5: 71f0746df1fc8b9069dffab76f992eb8
      size: 3916
    params:
      configs/params.yaml:
        preprocess.imputation_strategy: median
        preprocess.random_state: 42
        preprocess.scale: true
        preprocess.test_size: 0.2
        preprocess.val_size: 0.1
    outs:
    - path: data/processed/test.csv
      hash: md5
      md5: 74a05764f946ead1a0ab3add13ce8c1b
      size: 118556
    - path: data/processed/train.csv
      hash: md5
      md5: 79e20acbfe76e65358572fbee354f8f5
      size: 414033
    - path: data/processed/transformer.joblib
      hash: md5
      md5: aabc179a1a126eb631b32391a19c84f1
      size: 2837
    - path: data/processed/val.csv
      hash: md5
      md5: e08563a562b21f6a4589eb9081a77977
      size: 59295
  train:
    cmd: python -m src.models.train --params configs/params.yaml
    deps:
    - path: configs/params.yaml
      hash: md5
      md5: 7db577e79af1853c85f6c22697f21d66
      size: 628
    - path: data/processed/train.csv
      hash: md5
      md5: 79e20acbfe76e65358572fbee354f8f5
      size: 414033
    - path: data/processed/val.csv
      hash: md5
      md5: e08563a562b21f6a4589eb9081a77977
      size: 59295
    - path: src/models/train.py
      hash: md5
      md5: 78232d84c5c1301ae011919c1442e7bd
      size: 7850
    params:
      configs/params.yaml:
        model.type: random_forest
        train.cv_folds: 5
        train.n_trials: 20
    outs:
    - path: app/model_registry/model.joblib
      hash: md5
      md5: a88381261cedcbcd081bc06b373dd5b9
      size: 11672953
    - path: artifacts/metrics/train_metrics.json
      hash: md5
      md5: 4dca76301fb776b09a72deabd2bc3dce
      size: 232
  evaluate:
    cmd: python -m src.models.evaluate --params configs/params.yaml
    deps:
    - path: app/model_registry/model.joblib
      hash: md5
      md5: a88381261cedcbcd081bc06b373dd5b9
      size: 11672953
    - path: configs/params.yaml
      hash: md5
      md5: 7db577e79af1853c85f6c22697f21d66
      size: 628
    - path: data/processed/test.csv
      hash: md5
      md5: 74a05764f946ead1a0ab3add13ce8c1b
      size: 118556
    - path: src/models/evaluate.py
      hash: md5
      md5: 109bebe2b20cb7cf9ef17bfa0250e999
      size: 2150
    params:
      configs/params.yaml:
        evaluate.threshold: 0.5
    outs:
    - path: artifacts/metrics/test_metrics.json
      hash: md5
      md5: 540f9f3a4b93c9e4285c86fba5f2a464
      size: 95
    - path: artifacts/plots/confusion_matrix.png
      hash: md5
      md5: 43ddd7b5a6f2f76975bc50877e7784fd
      size: 23087
    - path: artifacts/plots/roc_curve.png
      hash: md5
      md5: 4bbc23e00a6d90f2f9ea3fb064225eea
      size: 37034
